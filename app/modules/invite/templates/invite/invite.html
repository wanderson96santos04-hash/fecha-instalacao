{% extends "base_app.html" %}

{% block content %}
<div class="max-w-3xl mx-auto p-4">
  <h1 class="text-2xl font-bold mb-2">Indique e cresÃ§a sem trÃ¡fego pago ðŸ“ˆ</h1>
  <p class="text-slate-600 mb-6">Copie seu link e mande no WhatsApp. Cada cÃ³pia e clique conta.</p>

  <div class="p-4 rounded-xl border mb-4">
    <div class="text-sm text-slate-600 mb-2">Seu link</div>
    <div class="flex gap-2">
      <input id="inviteLink" class="flex-1 border rounded-xl px-3 py-2" value="{{ invite_link }}" readonly />
      <button id="copyBtn" class="px-4 py-2 rounded-xl bg-slate-900 text-white text-sm font-semibold">Copiar link</button>
    </div>
    <div class="text-xs text-slate-500 mt-2">Copiado: <b>{{ copy_count }}</b> â€¢ Cliques: <b>{{ click_count }}</b></div>
  </div>

  <div class="p-4 rounded-xl border">
    <div class="text-sm text-slate-600 mb-2">Mensagem pronta</div>
    <textarea id="shareText" class="w-full border rounded-xl p-3" rows="4" readonly>{{ share_text }}</textarea>
    <div class="flex gap-2 mt-3">
      <button id="copyTextBtn" class="px-4 py-2 rounded-xl bg-green-600 text-white text-sm font-semibold">Copiar texto</button>
      <a class="px-4 py-2 rounded-xl border text-sm font-semibold"
         target="_blank"
         href="https://wa.me/?text={{ share_text | urlencode }}">
        Enviar no WhatsApp
      </a>
    </div>
  </div>
</div>

<script>
  async function postCopy() {
    try { await fetch("/app/invite/copy", { method: "POST" }); } catch (e) {}
  }
  function copyToClipboard(text) {
    if (!navigator.clipboard) return;
    navigator.clipboard.writeText(text).then(() => postCopy());
  }

  document.getElementById("copyBtn").addEventListener("click", () => {
    copyToClipboard(document.getElementById("inviteLink").value);
  });
  document.getElementById("copyTextBtn").addEventListener("click", () => {
    copyToClipboard(document.getElementById("shareText").value);
  });
</script>
{% endblock %}